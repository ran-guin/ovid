extends ./../layout
block content
 div(style="margin-top:50px") 
  div.alert.alert-info Visit Home Page #{JSON.stringify(me)} #{JSON.stringify(Config)}

  .container(style='width:90%')
    div(ng-app="myApp")
      if (recordId) 
        - Config['recordId'] = recordId
      else
        - recordId = Config['recordId']

      - var url = Config['url']
      - var init = "initialize(" + JSON.stringify(Config) + ")";

      div(ng-controller="Nto1Controller")
       div(ng-controller="VisitController" ng-init="#{init}" ngcloak)

        div#topMessage

        form#Queue(ng-submit="queue()")
          table.table(width='100%')
            tr
              td.col-md-4
                table
                  tr
                    td
                      b {{ clinic.name }} [ {{ clinic.id }} ]
                  tr 
                    td {{ clinic.address }}
              td.col-md-4(align='right')
                b {{ timestamp}}
                br
                b {{ user }}


          hr
          h3 {{items.length}} Immunization(s):
          b Items: {{ JSON.stringify(items[0]) }}...
          div(ng-if="items.length")
            table.table
              tr
                td &nbsp;
                td Disease
                td Vaccine
                td Description
                td Lot #
                td Route
                td Site
                td Reaction
                td Side Effects
                td Contraindications
                td Patient History
              tr(ng-repeat="q in items")
                td
                  button.btn.btn-danger.btn-xs(type='button' value="Delete" ng-click="deleteItem($index)") X
                  span &nbsp;
                  span(ng-if="! q.applied")
                    button.btn.btn-success.btn-xs(type='button' data-toggle='modal' data-target='#editImmunizationModal' ng-click="activateIndex($index)") Apply            
                  span(ng-if="q.applied")
                    button.btn.btn-warning.btn-xs(type='button' data-toggle='modal' data-target='#editImmunizationModal' ng-click="activateIndex($index)") Edit            
                    i.glyphicon.glyphicon-ok.navbar-right
                td {{ q.Disease }} : {{ Coverage }}
                td {{ q.Vaccine }}
                td {{ q.Vaccine_Description }}
                td {{ q.lot }}
                td {{ q.route }} 
                td {{ q.site }}
                td {{ q.reactions }}
                td {{ q.known_side_effect }}
                td {{ q.Contraindications }}
                td {{ q.History }}

        - var clearSearch = "document.getElementById('smartSearch').style.display='none'; document.getElementById('showSS').style.display='block';";
        button.btn.btn-primary.btn-xs#showScan(style='display:block' onclick="document.getElementById('smartScan').style.display='block'; document.getElementById('showScan').style.display='none'; " + clearSearch) scan barcode
        div#smartScan(style='display:none')
          hr(style='border-width:thick; border-color:black;')
          div#insideScan(style='padding:10px') 

          form#scanForm()
            div.input-group
              span.input-group-addon 
                button.btn.btn-xs.btn-danger#hideSS(onclick="document.getElementById('smartScan').style.display='none'; document.getElementById('showScan').style.display='block';") x
                span &nbsp;
                button.btn.btn-primary.btn-xs(type='button' ng-click="addBarcodedVaccine()") Add Barcoded Vaccine &nbsp;
              
              input.form-control(type='text' placeholder='-- Barcoded Vaccine --')
          br 
    
        include ./../Nto1/smartSearch.jade
        div 
          div.modal.fade#editImmunizationModal
            div.modal-dialog
              div.modal-content
                div.modal-header
                  button.close(type="button" class="close" data-dismiss="modal" aria-label="Close")
                    span(aria-hidden="true") &times;
                  h4.modal-title Apply Immunization
                div.modal-body
                  include editImmunization.jade
                  hr
                  div#insideModal
                div.modal-footer
                  button.btn.btn-default(type="button button-danger" data-dismiss="modal") Close